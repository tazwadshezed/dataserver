/*
 Copyright 2013 Draker - Pats Pending
*/
define(["jquery","static/_build/scripts/modules/urls","devices"],function(a, f, d){ss.weatherWidgets={template:function(){return'<div class="module weather"><div class="content"><div class="description"><p class="temperature"></p><p class="status"></p></div><div class="icon"></div></div></div>'},weatherWidget:{_init:function(b, c){this.options=a.extend({},this.options,b);this.$element=a(ss.weatherWidgets.template(this.options));this.element=this.$element[0];c?a(c).append(this.$element):a(".container_modules").append(this.$element);
var e=this;d.dataDefer.done(function(){e._getData()})},_getData:function(){var b=this;a.ajax({url:"http://api.wunderground.com/api/2d4c32f1d7e792cb/conditions/q/"+ss.devices.allData.sitearray.zipcode+".json",cache:!1,dataType:"jsonp",success:function(a){b.weatherData=a;b._build()},error:function(){ss.errorMessages({element:b.$element,type:"error",content:"Data failed to load",fixed:1<b.options.deviceID.length?!1:!0});b.$element.children(".content").children("img.loading").hide()}})},_build:function(){this.$element.find("img.loading").hide();
this.$element.find(".icon").addClass(this.weatherData.current_observation.icon);this.$element.find(".temperature").html(roundNumber(this.weatherData.current_observation.temp_f,0)+"&deg;");this.$element.find(".status").text(this.weatherData.current_observation.weather)},update:function(){this._getData()}}};return ss.weatherWidgets.weatherWidget});