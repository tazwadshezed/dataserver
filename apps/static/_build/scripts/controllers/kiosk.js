/*
 Copyright 2013 Draker - Pats Pending
*/
define(["jquery"],function(b){window.ss||(ss={});require(["statusWidgets"],function(a){a.template=function(){return'<div class="module arrayStatus">;<div class="title">;<h3>Energy Generation</h3>;</div>;<div class="content">;<div class="energyHistory">;<ul>;<li>;<h4>Today</h4>;<span class="value today">0</span> <span class="unit">kWh</span>;</li>;<li>;<h4>Week to Date</h4>;<span class="value week">0</span> <span class="unit">kWh</span>;</li>;<li>;<h4>Month to Date</h4>;<span class="value month">0</span> <span class="unit">MWh</span>;</li>;<li>;<h4>Year to Date</h4>;<span class="value year">0</span> <span class="unit">MWh</span>;</li>;</ul>;</div>;</div>;</div>'.split(";")}});
ss.kiosk={_init:function(){require(["dates"],function(a){a.min=function(a){var c=b("input[name=max_date]").length?b("input[name=max_date]").val().split("-"):[this.today.getFullYear(),this.today.getMonth()+1,this.today.getDate()];return"UTC"===a||"utc"===a?Date.UTC(+c[0],+c[1]-1,+c[2]-2):c[0]+"-"+c[1]+"-"+(c[2]-2)};b.post("/ss/date_range/","min_date="+ss.dates.min()+"&max_date="+ss.dates.max()).success(function(){b(document).ready(function(){ss.modules.create("statusWidgets",document.getElementById("container_arrayStatus"));
ss.modules.create("charts",document.getElementById("container_powerAndIrradiance"),{id:"powerAndIrradiance",deviceType:"env+arraycalc",deviceID:"env+SA-1",dataType:"irradiance_mean+P",chartType:"spline",title:"Power+Generation+Compared+to+Available+Sun+Energy",downloadWidget:!1,template:"kiosk",size:"full"});ss.modules.create("weatherWidgets",b(".column_group")[0]);ss.automation.automate()})})})}};ss.automation={updateModules:function(){b(document).trigger("updateModules")},checkDate:function(){var a=
new Date,a=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()),b=ss.dates.max("utc")||a;return b&&a==b?!0:!1},automate:function(){function a(){b.updateModules()}var b=this;this.checkDate()?this.updateInterval=setInterval(a,3E5):clearInterval(this.updateInterval)}};return ss.kiosk});